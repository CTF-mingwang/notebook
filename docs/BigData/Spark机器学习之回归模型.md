<div class="output_wrapper" id="output_wrapper_id" style="font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;"><h1 id="hspark" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.6em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">Spark机器学习之回归模型</span></h1>
<h2 id="h" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">前置准备</span></h2>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">IDEA、scala-2.11.12、jdk1.8</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">想要完成本期视频中所有操作，需要以下准备：</p>
<blockquote style="line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(129, 145, 152); border-left: 6px solid rgb(220, 230, 240); background: rgb(242, 247, 251) none repeat scroll 0% 0%; overflow: auto; overflow-wrap: normal; word-break: normal;">
  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;"><a href="https://mp.weixin.qq.com/s/IBZcW0LBO9KYJGrxxuFvww" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">Scala环境搭建-视频教程</a></p>
</blockquote>
<h2 id="h-1" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">一、最小二乘法</span></h2>
<div align="center" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"> <img src="https://raw.githubusercontent.com/xiaokangxxs/notebook/master/docs/BigData/Spark/least-square.png" width="600px" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"> </div>
<h2 id="hpom" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">二、pom依赖</span></h2>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="xml language-xml hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">&lt;?xml&nbsp;version="1.0"&nbsp;encoding="UTF-8"?&gt;</span><br><span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">project</span>&nbsp;<span class="hljs-attr" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">xmlns</span>=<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); word-wrap: inherit !important; word-break: inherit !important;">"http://maven.apache.org/POM/4.0.0"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">xmlns:xsi</span>=<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); word-wrap: inherit !important; word-break: inherit !important;">"http://www.w3.org/2001/XMLSchema-instance"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-attr" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">xsi:schemaLocation</span>=<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); word-wrap: inherit !important; word-break: inherit !important;">"http://maven.apache.org/POM/4.0.0&nbsp;http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">modelVersion</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span>cool.xiaokang<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span>SparkML<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span>1.0<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">properties</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">scala.version</span>&gt;</span>2.11.12<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">scala.version</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">spark.version</span>&gt;</span>2.4.5<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">spark.version</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">properties</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependencies</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span>org.scala-lang<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span>scala-library<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span>${scala.version}<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span>org.apache.spark<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span>spark-core_2.11<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span>${spark.version}<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span>org.apache.spark<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">groupId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span>spark-mllib_2.11<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">artifactId</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span>${spark.version}<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">version</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependency</span>&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">dependencies</span>&gt;</span><br><span class="hljs-tag" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&lt;/<span class="hljs-name" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(241, 250, 140); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;">project</span>&gt;</span><br></code></pre>
<h2 id="h-2" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">三、编码</span></h2>
<h3 id="h31" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; border-bottom: 2px solid rgb(0, 116, 217); margin-bottom: 50px; font-size: 1em;"><span style="font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; background: rgb(0, 116, 217) none repeat scroll 0% 0%; color: rgb(255, 255, 255); padding: 10px 16px; border-radius: 5px; box-shadow: rgb(0, 116, 217) 5px 5px 10px;">3.1 样本数据</span></h3>
<div align="center" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"> <img src="https://raw.githubusercontent.com/xiaokangxxs/notebook/master/docs/BigData/Spark/sample-item.jpg" width="600px" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"> </div>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">根据图中的样本数据来建立线性回归模型，预测X1=11、X2=450时Y的值</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;">lritem.txt</code>数据如下：</p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">100|5&nbsp;1000<br>75|7&nbsp;600<br>80|6&nbsp;1200<br>70|6&nbsp;500<br>50|8&nbsp;30<br>65|7&nbsp;400<br>90|5&nbsp;1300<br>100|4&nbsp;1100<br>110|3&nbsp;1300<br>60|9&nbsp;300<br></code></pre>
<h3 id="h32" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; border-bottom: 2px solid rgb(0, 116, 217); margin-bottom: 50px; font-size: 1em;"><span style="font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; background: rgb(0, 116, 217) none repeat scroll 0% 0%; color: rgb(255, 255, 255); padding: 10px 16px; border-radius: 5px; box-shadow: rgb(0, 116, 217) 5px 5px 10px;">3.2 核心代码</span></h3>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="scala language-scala" style="overflow-wrap: break-word; padding: 2px 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">package&nbsp;cool.xiaokang.lritem<br><br>import&nbsp;org.apache.spark.ml.feature.VectorAssembler<br>import&nbsp;org.apache.spark.ml.regression.LinearRegression<br>import&nbsp;org.apache.spark.rdd.RDD<br>import&nbsp;org.apache.spark.sql.{DataFrame,&nbsp;SparkSession}<br>import&nbsp;org.apache.spark.{SparkConf,&nbsp;SparkContext}<br><br>/**<br>&nbsp;*&nbsp;回归模型预测<br>&nbsp;*&nbsp;&nbsp;Y=β1X1+β2X2+β0<br>&nbsp;*&nbsp;&nbsp;Y=-6.497X1+0.016X2+106.368<br>&nbsp;*&nbsp;@author:&nbsp;xiaokang<br>&nbsp;*&nbsp;@date:&nbsp;2020/6/28&nbsp;14:58<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;微信公众号：小康新鲜事儿<br>&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;小康个人文档：https://www.xiaokang.cool/<br>&nbsp;*/<br>object&nbsp;PredictItemDemo&nbsp;{<br>&nbsp;&nbsp;def&nbsp;main(args:&nbsp;Array[String]):&nbsp;Unit&nbsp;=&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Spark配置对象<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;conf=new&nbsp;SparkConf()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setMaster("local[*]")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setAppName("PredictItemDemo")<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;SparkContext入口对象<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;sc=new&nbsp;SparkContext(conf)<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;SparkSession对象<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;sparkSession=SparkSession.builder()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.master("local[*]")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.appName("PredictItemDemo")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getOrCreate()<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;data:RDD[String]&nbsp;=&nbsp;sc.textFile("D:/IDEA-Projects/SparkML/lritem.txt")<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;第一步：将RDD[String]-&gt;RDD[(X1,X2,Y)]<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;itemR1:RDD[(Double,Double,Double)]&nbsp;=&nbsp;data.map(line&nbsp;=&gt;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;info&nbsp;=&nbsp;line.split("\\|")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;Y&nbsp;=&nbsp;info(0).toDouble<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;X1&nbsp;=&nbsp;info(1).split("&nbsp;")(0).toDouble<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;X2&nbsp;=&nbsp;info(1).split("&nbsp;")(1).toDouble<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(X1,&nbsp;X2,&nbsp;Y)<br>&nbsp;&nbsp;&nbsp;&nbsp;})<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;第二步：将RDD[(X1,X2,Y)]-&gt;DataFrame(X1,X2,Y)<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;itemDf:DataFrame&nbsp;=&nbsp;sparkSession.createDataFrame(itemR1).toDF("X1",&nbsp;"X2",&nbsp;"Y")<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;第三步：将DataFrame(X1,X2,Y)-&gt;DataFrame(Vectors(X1,X2),Y)才能建模<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;转换工具类<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;vectorAssembler=new&nbsp;VectorAssembler()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setInputCols(Array("X1","X2"))&nbsp;//指定自变量列名<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setOutputCol("features")&nbsp;//所有自变量起别名（自行DIY），可以通过此列名找到所有自变量<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;itemDfVectors:DataFrame&nbsp;=&nbsp;vectorAssembler.transform(itemDf)<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;第四步：建立回归模型，底层使用最小二乘法进行建模<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;model=new&nbsp;LinearRegression()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setFeaturesCol("features")&nbsp;//&nbsp;告诉模型哪些是自变量<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setLabelCol("Y")&nbsp;//&nbsp;告诉模型因变量<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.setFitIntercept(true)&nbsp;//&nbsp;计算截距系数<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.fit(itemDfVectors)&nbsp;//&nbsp;带入数据进行建模<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;自变量系数<br>&nbsp;&nbsp;&nbsp;&nbsp;//println(model.coefficients)<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;截距系数<br>&nbsp;&nbsp;&nbsp;&nbsp;//println(model.intercept)<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;第五步：通过模型进行预测<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;itemPredict&nbsp;=&nbsp;model.transform(itemDfVectors)<br>&nbsp;&nbsp;&nbsp;&nbsp;//itemPredict.show()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+------+-----+------------+------------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|&nbsp;X1|&nbsp;&nbsp;&nbsp;&nbsp;X2|&nbsp;&nbsp;&nbsp;&nbsp;Y|&nbsp;&nbsp;&nbsp;&nbsp;features|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prediction|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+------+-----+------------+------------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|5.0|1000.0|100.0|[5.0,1000.0]|&nbsp;&nbsp;90.2012541654423|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|7.0|&nbsp;600.0|&nbsp;75.0|&nbsp;[7.0,600.0]|&nbsp;70.67991272108885|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|6.0|1200.0|&nbsp;80.0|[6.0,1200.0]|&nbsp;&nbsp;86.9677455657187|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|6.0|&nbsp;500.0|&nbsp;70.0|&nbsp;[6.0,500.0]|&nbsp;75.54521185142573|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|8.0|&nbsp;&nbsp;30.0|&nbsp;50.0|&nbsp;&nbsp;[8.0,30.0]|54.881617035642996|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|7.0|&nbsp;400.0|&nbsp;65.0|&nbsp;[7.0,400.0]|&nbsp;&nbsp;67.4163316598623|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|5.0|1300.0|&nbsp;90.0|[5.0,1300.0]|&nbsp;95.09662575728214|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|4.0|1100.0|100.0|[4.0,1100.0]|&nbsp;98.33013435700573|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|3.0|1300.0|110.0|[3.0,1300.0]|108.09080507918245|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|9.0|&nbsp;300.0|&nbsp;60.0|&nbsp;[9.0,300.0]|&nbsp;&nbsp;52.7903618073487|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+------+-----+------------+------------------+<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;X1=11,X2=450时，预测Y<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;testR1:RDD[(Int,Int,Int)]&nbsp;=&nbsp;sc.makeRDD(List((11,&nbsp;450,&nbsp;0)))<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;testDf&nbsp;=&nbsp;sparkSession.createDataFrame(testR1).toDF("X1",&nbsp;"X2",&nbsp;"Y")<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;testDfVectors&nbsp;=&nbsp;vectorAssembler.transform(testDf)<br>&nbsp;&nbsp;&nbsp;&nbsp;val&nbsp;testPredict&nbsp;=&nbsp;model.transform(testDfVectors)<br>&nbsp;&nbsp;&nbsp;&nbsp;testPredict.show()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+---+---+------------+-----------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|&nbsp;X1|&nbsp;X2|&nbsp;&nbsp;Y|&nbsp;&nbsp;&nbsp;&nbsp;features|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prediction|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+---+---+------------+-----------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;|&nbsp;11|450|&nbsp;&nbsp;0|[11.0,450.0]|42.24386828136832|<br>&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;+---+---+---+------------+-----------------+<br>&nbsp;&nbsp;}<br>}<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">源码下载地址：<a href="https://github.com/xiaokangxxs/notebook/tree/master/docs/code/SparkML" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">SparkML</a></p>
<h3 id="h33" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; border-bottom: 2px solid rgb(0, 116, 217); margin-bottom: 50px; font-size: 1em;"><span style="font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; background: rgb(0, 116, 217) none repeat scroll 0% 0%; color: rgb(255, 255, 255); padding: 10px 16px; border-radius: 5px; box-shadow: rgb(0, 116, 217) 5px 5px 10px;">3.3 课后作业</span></h3>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">牙膏市场分析以及风险预测数据如下</p>
<div align="center" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"> <img src="https://raw.githubusercontent.com/xiaokangxxs/notebook/master/docs/BigData/Spark/sample-toothpaste.jpg" width="600px" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"> </div>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;"><code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;">toothpaste.txt</code>数据如下：</p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;">80|7.8&nbsp;11&nbsp;200<br>56|8.1&nbsp;11&nbsp;160<br>110|7.5&nbsp;10.5&nbsp;120<br>20|9&nbsp;12&nbsp;180<br>12|10&nbsp;13&nbsp;200<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">预测X1=9.5、X2=15、X3=300时Y的值？如果没有思路可以加联系小康老师，还有就是答案做出来记得评论哦！</p></div>