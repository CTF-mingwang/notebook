<div class="output_wrapper" id="output_wrapper_id" style="font-size: 16px; color: rgb(62, 62, 62); line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;"><h1 id="hshellzk" style="color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px; font-weight: bold; font-size: 1.6em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">大数据常用shell脚本之zk脚本</span></h1>
<h2 id="h" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">一、前置准备</span></h2>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">CentOS7、jdk1.8、zookeeper-3.5.7</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">想要完成本期视频中所有操作，需要以下准备：</p>
<blockquote style="line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(129, 145, 152); border-left: 6px solid rgb(220, 230, 240); background: rgb(242, 247, 251) none repeat scroll 0% 0%; overflow: auto; overflow-wrap: normal; word-break: normal;">
  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;"><a href="https://mp.weixin.qq.com/s/JPM44UGuv5RdEx4LBfY_FA" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">Zookeeper单机环境和集群环境搭建视频+图文教程</a></p>
  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;"><a href="https://mp.weixin.qq.com/s/NLpvOiqr8tLDY4kA3EM7Zg" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">Hadoop完全分布式集群环境搭建-视频教程</a></p>
  <p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;"><a href="https://mp.weixin.qq.com/s/W269rv7-kSO6CIhsUMqbXA" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">大数据常用shell脚本之分发脚本编写-视频教程</a></p>
</blockquote>
<h2 id="h-1" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">二、简单了解</span></h2>
<ul style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;">
<li style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;">登录式 Shell， 采用用户名密码，比如 xiaokang 登录， 会自动加载<code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;">/etc/profile</code></li>
<li style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;">非登录式 Shell， 采用 ssh 比如 ssh hadoop02 登录， 不会自动加载<code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;">/etc/profile</code>， 会自动加载<code style="font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(233, 105, 0); background: rgb(248, 248, 248) none repeat scroll 0% 0%;">~/.bashrc</code></li>
</ul>
<div align="center" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"> <img src="https://raw.githubusercontent.com/xiaokangxxs/notebook/master/docs/Shell/zk-shell-env.png" width="600px" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"> </div>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">想要通过非登录式 Shell 来使用其它节点的环境变量就需要做以下操作：</p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;1.将当前节点的/etc/profile中已经配置好的环境变量复制到/etc/profile.d/env.sh(此文件需要手动创建)</span><br>[xiaokang@hadoop01&nbsp;bin]$&nbsp;sudo&nbsp;vim&nbsp;/etc/profile.d/env.sh<br><br>export&nbsp;JAVA_HOME=/opt/moudle/jdk1.8.0_191<br>export&nbsp;JRE_HOME=${JAVA_HOME}/jre<br>export&nbsp;HADOOP_HOME=/opt/software/hadoop-2.7.7<br>export&nbsp;ZOOKEEPER_HOME=/opt/software/zookeeper-3.5.7<br>export&nbsp;HIVE_HOME=/opt/software/hive-2.3.6<br>export&nbsp;HBASE_HOME=/opt/software/hbase-1.4.13<br>export&nbsp;KYLIN_HOME=/opt/software/kylin-3.0.1<br>export&nbsp;KAFKA_HOME=/opt/software/kafka-2.1.0<br>export&nbsp;CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib<br>export&nbsp;PATH=${JAVA_HOME}/bin:${HADOOP_HOME}/bin:${HADOOP_HOME}/sbin:${ZOOKEEPER_HOME}/bin:${HIVE_HOME}/bin:${HBASE_HOME}/bin:${KYLIN_HOME}/bin:${KAFKA_HOME}/bin:$PATH<br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;"><br>#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;2.分发至各个节点</span><br>[root@hadoop01&nbsp;~]$&nbsp;distribution.sh&nbsp;/etc/profile.d/env.sh<br></code></pre>
<h2 id="h-2" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">三、脚本源码</span></h2>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">!/bin/bash</span><br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;"><br>#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">作者：小康</span><br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">描述：zookeeper集群启动/停止/查看状态脚本</span><br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">微信公众号：小康新鲜事儿</span><br><br>USAGE="使用方法：sh&nbsp;zk.sh&nbsp;start/stop/status"<br>if&nbsp;[&nbsp;$#&nbsp;-ne&nbsp;1&nbsp;];then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$USAGE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit&nbsp;1<br>fi<br>NODES=("hadoop01"&nbsp;"hadoop02"&nbsp;"hadoop03")<br>ZOOKEEPER_HOME=/opt/software/zookeeper-3.5.7<br>case&nbsp;$1&nbsp;in<br>"start")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;NODE&nbsp;in&nbsp;${NODES[*]};do<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"--------$NODE启动zookeeper--------"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssh&nbsp;$NODE&nbsp;"$ZOOKEEPER_HOME/bin/zkServer.sh&nbsp;start"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;<br>"stop")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;NODE&nbsp;in&nbsp;${NODES[*]};do<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"--------$NODE停止zookeeper--------"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssh&nbsp;$NODE&nbsp;"$ZOOKEEPER_HOME/bin/zkServer.sh&nbsp;stop"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;<br>"status")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;NODE&nbsp;in&nbsp;${NODES[*]};do<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;"--------$NODE查看zookeeper状态--------"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssh&nbsp;$NODE&nbsp;"$ZOOKEEPER_HOME/bin/zkServer.sh&nbsp;status"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;done<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;<br>*)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$USAGE<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;;<br>esac<br>echo&nbsp;"----------------------------------------------------------------------------------------"<br>echo&nbsp;"--------zk.sh脚本执行完成!--------"<br>echo&nbsp;-e&nbsp;"--------微信公众号：\033[5;31m&nbsp;小康新鲜事儿&nbsp;\033[0m--------"<br>echo&nbsp;"--------小康老师微信：k1583223--------"<br>echo&nbsp;"--------公众号内回复【大数据】，获取系列教程及随堂文档--------"<br>echo&nbsp;"----------------------------------------------------------------------------------------"<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">脚本下载地址：<a href="https://github.com/xiaokangxxs/notebook/blob/master/docs/Shell/zk.sh" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;">https://github.com/xiaokangxxs/notebook/blob/master/docs/Shell/zk.sh</a></p>
<h2 id="h-3" style="line-height: inherit; margin: 1.5em 0px; font-weight: bold; font-size: 1.4em; margin-bottom: 2em; margin-right: 5px; padding: 8px 15px; letter-spacing: 2px; background-image: linear-gradient(to right bottom, rgb(0, 188, 212), rgb(63, 81, 181)); background-color: rgb(63, 81, 181); color: rgb(255, 255, 255); border-left: 10px solid rgb(51, 51, 51); border-radius: 5px; text-shadow: rgb(34, 34, 34) 2px 2px 3px; box-shadow: rgb(102, 102, 102) 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">四、测试使用</span></h2>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;修改脚本权限</span><br>[xiaokang@hadoop01&nbsp;bin]$&nbsp;chmod&nbsp;777&nbsp;zk.sh<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">执行方式：</p>
<pre style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"><code class="shell language-shell hljs" style="overflow-wrap: break-word; margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 0.5em; background: rgb(40, 42, 54) none repeat scroll 0% 0%; color: rgb(248, 248, 242); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;方式一</span><br>[xiaokang@hadoop01&nbsp;bin]$&nbsp;./zk.sh&nbsp;start<br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;方式二</span><br>[xiaokang@hadoop01&nbsp;bin]$&nbsp;sh&nbsp;zk.sh&nbsp;start<br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;方式三</span><br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;1.将shell脚本所在目录配置为环境变量（/etc/profile），记得<span class="hljs-built_in" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">source</span>生效</span><br>export&nbsp;SHELL_HOME=/home/xiaokang/bin<br>export&nbsp;PATH=${JAVA_HOME}/bin:${HADOOP_HOME}/bin:${HADOOP_HOME}/sbin:${ZOOKEEPER_HOME}/bin:${HIVE_HOME}/bin:${HBASE_HOME}/bin:${KYLIN_HOME}/bin:${KAFKA_HOME}/bin:${SCALA_HOME}/bin:${SCALA_HOME}/sbin:${SPARK_HOME}/bin:${SHELL_HOME}/:$PATH<br><span class="hljs-meta" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(98, 114, 164); word-wrap: inherit !important; word-break: inherit !important;">#</span><span class="bash" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;">&nbsp;2.在任意目录都可以使用自己编写的shell脚本</span><br>[xiaokang@hadoop01&nbsp;~]$&nbsp;zk.sh&nbsp;start<br></code></pre>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.5em 0px;">使用脚本进行启动和查看状态测试，成功如下图所示：</p>
<div align="center" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;"> <img src="https://raw.githubusercontent.com/xiaokangxxs/notebook/master/docs/Shell/zk-shell-start.png" width="600px" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;"> </div></div>